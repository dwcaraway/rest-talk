<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Pragmatic REST</title>

		<meta name="description" content="A framework for easily creating beautiful presentations using HTML">
		<meta name="author" content="Hakim El Hattab">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<link rel="stylesheet" href="css/reveal.min.css">
		<link rel="stylesheet" href="css/theme/beige.css" id="theme">

		<!-- For syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- If the query includes 'print-pdf', use the PDF print sheet -->
		<!--
		<script>
			document.write( '<link rel="stylesheet" href="css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );
		</script>-->

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">


				<section>
					<h1>Pragmatic REST</h1>
          <h2>By Dave Caraway</h2>
					<p>
						<small>
              <a href="mailto:dave@fogmine.com">dave@fogmine.com</a></small>
					</p>
				</section>

        <section>
              <section data-markdown>
                  <script type="text/template">
                    # What is REST?
                  </script>
              </section> 

              <section data-markdown>
              <script type="text/template">
                    ## REST
                    * Stands for Representational State Transfer
                    * Is a convention for architecting web services, NOT a technology
                    * Built around the concept of resources, which are just sources of information on the web
                    * Involves sessionless dialogs using state transfer and standard HTTP methods
                    * Based on idea that a good design will indicate its own use, which reduces developer reliance on documentation
                    * Conventions enable reusable libraries and tools
                    * Allows new developers to start using an API almost immediately
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                    ## Source
                    * Originated in chapter 5 of [Roy Fielding's 2000 Ph. D. Dissertation](http://www.ics.uci.edu/~fielding/pubs/dissertation/top.htm)
                    * Fielding's REST is not an architecture but a way of judging architectures
                    * Fielding description left many unanswered questions, resulting in contention over what is and is not REST
                    * Many sources of information on REST have been informal: mailing lists, wikis and weblogs
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## [HTTP](http://www.w3.org/Protocols/)
                * Hypertext Transfer Protocol
                * A request-response architecture
                  + client provides request method, URI and protocol version followed by message with request modifiers, client information and (possibly) body content
                  + Server responds with status code, (possibly) response body
                * Building block of the Internet as we know it
                * Normally over TCP/IP transport protocol, but can support others as long as they are reliable
                * Headers are visible, body is encoded in an envelope with associated Content-Type
                * Trivia note: Fielding co-wrote the HTTP standard
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## CRUD 
                * Uses HTTP methods
                  + POST (Create)
                  + GET (Read)
                  + PUT (Update)
                  + DELETE (Delete)
                * PUT can sometimes be used  to create if the API Allows
                  + PUT /some/resource/{requestedid} should create a new resource at the requested URI if supported  
                * HTML only supports GET and POST
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Other HTTP methods
                * PATCH
                  + Partial update, not requiring full representation (and thus less bandwidth)
                  + Caveat: not idempotent and some clients do not support patch
                * OPTIONS
                  + Indicates what HTTP methods can be used on a given resource
                  + May include a response body, although HTTP 1.1 doesn't require it
                * HEAD
                  + Like GET, except no response body
                  + Useful for determining response codes, Content-Type and other header information 
                * Put everything else behind a ? (in a query string)
              </script>
              </section>

             <section data-markdown>
              <script type="text/template">
                ## [Safe Methods and Idempotence](http://restcookbook.com/HTTP%20Methods/idempotency/)
                * Safe Methods
                  + should never change a resource representation on the server
                  + GET and HEAD are safe methods
                * Idempotence
                  + property that N>0 identical requests yields the same result as initial application
                  + `a=4;` is idempotent
                  + `a++;` is not idempotent
                  + GET, HEAD, PUT and DELETE are idempotent
                  + POST is not idempotent
                * Trivia note: Fielding co-wrote the HTTP standard
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Query Strings
                * filters
                  * boolean operators
                  * http://www.petshop.com/cats?name=fluffy&color=black&age%3C1&order=1
                * query
                  * full text search
                  * http://www.petshop.com/cats?q=fluffy+black+kitten&order=1
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Example HTTP Request & Response
                  [Twilio API](https://api.twilio.com/2010-04-01)

                ### Request Header
                <pre><code>
                  Content-Type: text/plain; charset=utf-8 
                  Accept: */*
                  Accept-Encoding: gzip,deflate,sdch
                  ...
                  </code></pre>
                ### Response Header 
<pre><code>
                  Content-Type: application/xml 
                  Content-Length: 213 
                  ...
                </code></pre>
              </script>
              </section>

              <section>
                Response Body
                <pre><code>
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;TwilioResponse&gt;
  &lt;Version&gt;
    &lt;Name&gt;2010-04-01&lt;/Name&gt;
    &lt;Uri&gt;/2010-04-01&lt;/Uri&gt;
    &lt;SubresourceUris&gt;
      &lt;Accounts&gt;/2010-04-01/Accounts&lt;/Accounts&gt;
    &lt;/SubresourceUris&gt;
  &lt;/Version&gt;
&lt;/TwilioResponse&gt;
                  </code></pre>
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                    ## State
                    * Server is stateless
                    * Application state resides on the client
                    * Each request should convey all state required to process the request
                    * Given a state and request, the server will determine the next state and generate a response
              </script>
              </section>


              <section data-markdown>
              <script type="text/template">
                    ## Communicating State
                    * If the client needs to carry forward state from one request to another, use links
                    * Encode application state into URIs (small size)
                    * If state is large or can't be transported for security or privacy reasons, store in durable storage (db, filesystem) and encode reference to state in URI
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                    ## Links Relations
                    * expressed by <code>rel</code> element
                    * expressed as URI, such as <code>http://www.example.org/rels/</code>
                    * provide informational resource such as HTML at the URI, with document describing semantics of link relation. Include details such as HTTP methods supported, representaiton formats supported for requests and responses, and business rules about using the link
                    * there are a number of common rel types
              </script>
              </section>

                            <section data-markdown>
              <script type="text/template">
                    ## Common REL types
                    <table>
                    <tr>
                    <td>self</td><td>For links to preferred URI of this resource</td></tr>
                    <tr>
                    <td>alternate</td><td>For links to URI for alternate version of same resource</td></tr>
                    <tr>
                    <td>edit</td><td>Link to URI for clients to edit this resource</td></tr>
                    <tr>
                    <td>related</td><td>Link to a related resource</td></tr>
                    <tr>
                    <td>previous or next</td><td>Link to previous or next resource in an ordered series of resources</td></tr>   
                    <tr>
                    <td>first or last</td><td>Link to first or last resource in an ordered series of resources</td></tr>
                    </table>
              </script>
              </section>

              <section>
              #State Transfer Example1 Part1
<pre><code>              
# Request
POST /quotegen HTTP/1.1
Host: www.example.org
Content-Type: application/x-www-form-urlencoded

fname=...&lname=...&..

# Response
HTTP/1.1 200 OK
Content-Type: application/xml;charset=UTF-8
&lt;quote xmlns:atom="http://www.w3.org/2005/Atom"&gt;
  &lt;driver&gt;
    ...
  &lt;/driver&gt;
  &lt;vehicle&gt;
    ...
  &lt;/vehicle&gt;
  &lt;offer&gt;
    ...
    &lt;valid-until&gt;2009-10-02&lt;/valid-until&gt;
    &lt;atom:link href="http://www.example.org/quotes/buy?quote=abc1234"
          rel="http://www.example.org/rels/quotes/buy"/&gt; 
  &lt;/offer&gt;
&lt;/html&gt; 
</code></pre>
              </section>

<section>
              State Transfer Example1 Part2
<pre><code>              
# Request
POST /quotegen HTTP/1.1
Host: www.example.org
Content-Type: application/x-www-form-urlencoded

fname=...&lname=...&..

# Response
HTTP/1.1 200 OK
Content-Type: application/xml;charset=UTF-8
&lt;quote xmlns:atom="http://www.w3.org/2005/Atom"&gt;
  &lt;driver&gt;
    ...
  &lt;/driver&gt;
  &lt;vehicle&gt;
    ...
  &lt;/vehicle&gt;
  &lt;offer&gt;
    ...
    &lt;valid-until&gt;2009-10-02&lt;/valid-until&gt;
    &lt;atom:link href="http://www.example.org/quotes/buy?quote=abc1234"
          rel="http://www.example.org/rels/quotes/buy"/&gt; 
  &lt;/offer&gt;
&lt;/html&gt; 
</code></pre>
              </section>

              <section>
              <h2>Example 2: Hiring System, Part 1</h2>
<table>
<tr><td><strong>URI</strong></td><td><strong>Purpose</strong></td></tr>
<tr><td>http://www.example.org/hires</td><td>Create a candidate resource</td></tr>
<tr><td>  http://www.example.org/hires/{id}/refs  </td><td>Submit reference comments.</td></tr>
<tr><td>  http://www.example.org/hires/{id}/bgchecks  </td><td>Submit background check results.</td></tr>
<tr><td>  http://www.example.org/hires/{id}/hire  </td><td>Make an offer.</td></tr>
<tr><td> http://www.example.org/hires/{id}/no-hire </td><td>Do not make an offer.</td></tr>
</table>

              </section>

                            <section>
              <h2>Example 2: Hiring System, Part 2</h2>
<pre><code>
# Request to enter candidate info
POST /hires HTTP/1.1
Host: www.example.org
Content-Type: application/json

{
  "name": "Joe Prospect",
  ...
}

# Response containing a link to post reference checks
HTTP/1.1 201 Created
Location: http://www.example.org/hires/099
Content-Location: http://www.example.org/hires/099
Content-Type: application/json

{
  "name": "Joe Prospect",
  "id": "urn:example:hr:hiring:099",
  ...
  "link" : { 
    "rel" : "http://www.example.org/rels/hiring/post-ref-result",
    "href" : "http://www.example.org/hires/099/refs"
  }
}
</code></pre>

              </section>


<section>
<h2>Example 2: Hiring System, Part 3</h2>
<pre><code>
# Request to enter first reference comment
POST /hires/099/refs HTTP/1.1
Host: www.example.org
Content-Type: application/json

{
  "text" : "Joe is a ...",
  "by" : "...",
  "on" : "2009:10:12T16:05:00Z"
}

# Response
HTTP/1.1 200 OK
Content-Location: http://www.example.org/hires/099
Content-Type: application/json

{
  "name": "Joe Prospect",
  "id": "urn:example:hr:hiring:099",
  ...
  "link" : {
    "rel" : "http://www.example.org/rels/hiring/post-ref-result",
    "href" : "http://www.example.org/hires/099/refs"
  }
}

# Request to enter second reference comment
POST /hires/099/refs HTTP/1.1
Host: www.example.org
Content-Type: application/json

{
  "text" : "Worked with Joe, ...",
  "by" : "...",
  "on" : "2009:10:12T17:00:00Z"
}

# Response
HTTP/1.1 200 OK
Content-Location: http://www.example.org/hires/099
Content-Type: application/json

{
  "name": "Joe Prospect",
  "id": "urn:example:hr:hiring:099",
  "refs": ...,
  ...
  "links" : [{ 
      "rel" : "http://www.example.org/rels/hiring/add-ref-result",
      "href" : "http://www.example.org/hires/099/refs"
    },
    { 
      "rel" : "http://www.example.org/rels/hiring/add-background-check",
      "href" : "http://www.example.org/hires/099/bgchecks"
    }]
} 

</code></pre>


</section>

<section>
<h2>Example 2: Hiring System, Part 4</h2>
<pre><code>
# Request to submit background check results
POST /hires/099/bgchecks HTTP/1.1
Host: www.example.org
Content-Type: application/json
{
  "text" : "...",
  "by" : "...",
  "on" : "..."
}

# Successful background check
HTTP/1.1 200 OK
Content-Location: http://www.example.org/hires/099
Content-Type: application/json;charset=UTF-8

{
  "prospect" : {
    "name": "Joe Prospect",
    "id": "urn:example:hr:hiring:099",
    "refs": ...,
    "link" : { 
      "rel" : "http://www.example.org/rels/hiring/make-offer",
      "href" : "http://www.example.org/hires/099/hire"
    }
  }
} 
</code></pre>


</section>
















              <section data-markdown>
              <script type="text/template">
                ## URLs
                * based on nouns, not verbs
                * two urls per resource
                  + collection (e.g. /polls )
                  + element in collection (e.g. /polls/{id})
                * Prefer plural over singular nouns for collections
                  + /polls, /birds, /aardvarks rather tha
                * Prefer concrete over abstract names
                  + /dog rather than /pet
                * For non-resources, use verbs not nouns
                  * e.g. /convert or /render
                * Moving content: redirects and permant move codes
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## SEARCH
                * scoped (particular to a resource, make a verb of that resource)
                * global (use search verb)
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Limiting Results
                * Use field specification to limit fields returned
                  + TODO add example
                * Pagination
                  + TODO add example
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Format
                * REST is independent of Format
                * Most REST apis are JSON, XML, or HTML, but RSS, ATOM and other formats are just as viable
                * Ways of indicating prefered format
                  + Included as part of the URL   
                    * e.g. /foo.json or /foo.xml
                  + Content Negotion
                    * Content type specified in the request
                    * HTTP Header (accept type)
                  + Recommend using URL over content negotiation for easy comprehension
                * Use camel-case naming conventions for JSON attributes
                  + e.g. 'createdAt' rather than 'CreatedAt' or 'created_at'
                  + why? because you can use the . ('dot') operator
                  + myjson.createdAt rather than myjson['some_bad_name']
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Errors
                * Use appropriate status code and message
                * [HTTP 4XX Error Status Code (integer)](http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html)
                * Error messages (text) describing the problem
                * Twilio Example
<pre><code data-trim>                  
&lt;TwilioResponse&gt;
&lt;RestException&gt;
&lt;Status&gt;401&lt;/Status&gt;
&lt;Message&gt;Authentication Error - No credentials provided&lt;/Message&gt;
&lt;Code&gt;20003&lt;/Code&gt;
&lt;MoreInfo&gt;https://www.twilio.com/docs/errors/20003&lt;/MoreInfo&gt;
 &lt;/RestException&gt;
&lt;/TwilioResponse&gt;
</code></pre>
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Versioning
                * Version your APIs!
                * Many options
                  + Version the URL
                    * api/v1/foo
                    * see https://api.twilio.com/
                  + Put versions in headers
                    * see
                * Best practice: mix & match
                  + major revisions in URL
                  + minor revisions in headers
              </script>
              </section>

              <section data-markdown>
              <script type="text/template">
                ## Authentication
                * Always use SSL (TODO provide why and example/counter-example)
                * Can use http basic
                * Recommend OAuth 2.0
              </script>
              </section>
        </section>

            <section>
               <section data-markdown>
               <script type="text/template">
                # How do I design using REST?
               </script>
               </section>
            </section>

            <section>
                   <section data-markdown>
                   <script type="text/template">
                      # What are some helpful tools for REST?
                   </script>
                   </section>

                    <section data-markdown>
                    <script type="text/template">
                      ## Documentation
                      * Often the first thing checked by a developer
                      * No docs usually indicates a rough or unfinished product (even though with REST, documentation isn't nearly as important as with less standardized interfaces)
                    </script>
                    </section>

                    <section data-markdown>
                    <script type="text/template">
                      ## Swagger
                      * Often the first thing checked by a developer
                      * 
                    </script>
                    </section>

                    <section data-markdown>
                    <script type="text/template">
                      ## Code libraries and SDKs
                      * # TODO #
                    </script>
                    </section>

                    <section data-markdown>
                    <script type="text/template">
                      ## REST Client
                      * Browser
                        + Advanced REST Client (Chrome)
                        + ??? (Firefox)
                        + ??? (IE)
                        + ??? (Safari)

                    </script>
                    </section>

            </section>
            
            <section>
               <section data-markdown>
               <script type="text/template">
                  # What are some good example REST services?
               </script>
               </section>

               <section data-markdown>
               <script type="text/template">
                  ## Interesting Projects
                  * [Twitter](http://www.twitter.com/api)
                  * [Github](http://www.github.com/api)
                  * [How to Turn a Raspberry Pi into a Low-Power NAS](http://www.howtogeek.com/139433/how-to-turn-a-raspberry-pi-into-a-low-power-network-storage-device/)
                  * [Turning the Raspberry Pi Into an FM Transmitter](http://www.icrobotics.co.uk/wiki/index.php/Turning_the_Raspberry_Pi_Into_an_FM_Transmitter)
                  * [用 Raspberry Pi 打造真正的豆瓣FM](http://www.freemindworld.com/blog/2013/130218_douban_fm_with_raspberry_pi.shtml)
               </script>
               </section>

            </section>
           
            <section>

               <section data-markdown>
                 <script type="text/template">
                    # What is hypermedia?
                 </script>
              </section>

               <section data-markdown>
                 <script type="text/template">
                    ## Hypermedia
                    * Per Fielding, required for "REST"
                    * Describes internet of things
                      + Machine readability
                      + Semantic Web
                    * Mike Amundsen (Wrote "Building Hypermedia APIs with HTML5 and Node" )
                    * Mike Kelly (creator of HAL)
                    * 
                    * Special Media Type (MIME Type)
                      + vnd/collection+json
                      + vnd/hal+json
                      + vnd/siren+json
                 </script>
              </section>

              <section data-markdown>
                <script type="text/template">
                    ## Type Marshalling Delimna
                    1. Shared Schema 
                    2. URI Construction
                    3. Payload Decoration
                    4. Narrow Media Type
               </script>
               </section>

              <section data-markdown>
                <script type="text/template">
                    ## Shared Schema
                    * Publish document listing arguments and interaction details. 
                    * Disadvantages: schema changes break clients as schema information not updated dynamically
                </script>
              </section>

              <section data-markdown>
                <script type="text/template">
                    ## URI Construction
                    * Have URI carry type information, easy to generate URI from metadata in service code
                    * Popular
                    * Easy for frameworks using templating and other processing based on type
                    * Drawback: Lose control of URIs
                      + Changes may break cached (bookmarked) links.
                 </script>
              </section>   

              <section data-markdown>
                  <script type="text/template">
                    ## Payload Decoration
                    * Add (meta) to htm, "type" to JSON, etc
                    * Process data based on type hint. 
                    * Drawback: payload tightly bound to source code; changes break existing clients if not realizing new payload info required.
                    4. Narrow Media Type: (JAX-RS) @Consumes("application/stockquote+xml") Full control over URI & payload, but any independent client would have great difficulty keeping up with changes
                 </script>
             </section>

             <section data-markdown>
                  <script type="text/template">
                    ## Narrow Media Type 
                    * (JAX-RS) @Consumes("application/stockquote+xml") 
                    * Full control over URI & payload
                    * Drawback: any independent client would have great difficulty keeping up with changes
                 </script>
             </section>
          </section>


           <section data-markdown>
             <script type="text/template">
                # Q & A
                ### [@davecaraway](http://twitter.com/davecaraway)
                ![url](images/qrcontactinfo.png)
             </script>
          </section>

			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.min.js"></script>

		<script>

			// Full list of configuration options available here:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
				transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

				// Optional libraries used to extend on reveal.js
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
					{ src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
					// { src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
				]
			});

		</script>

	</body>
</html>
